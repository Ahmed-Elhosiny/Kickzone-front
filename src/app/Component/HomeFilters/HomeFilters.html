<div class="filters-container">
  @if (isLoading()) {
    <div class="loading-state">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  } @else {
    <form class="filters-form" #f="ngForm" (ngSubmit)="f.form.valid && applyFilter()">
      <div class="form-fields">
        <!-- Category Select -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Sport</mat-label>
          <mat-icon matPrefix>sports_soccer</mat-icon>
          <mat-select
            [value]="selectedCategoryName()"
            (valueChange)="selectedCategoryName.set($event)"
            name="category"
            #categorySelect="ngModel"
            [ngModel]="selectedCategoryName()"
            required
          >
            @for(cat of categories(); track cat.id) {
              <mat-option [value]="cat.name">{{ cat.name }}</mat-option>
            }
          </mat-select>
          @if (categorySelect.invalid && (categorySelect.touched || f.submitted)) {
            <mat-error>Sport required</mat-error>
          }
        </mat-form-field>

        <!-- City Select -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>City</mat-label>
          <mat-icon matPrefix>location_on</mat-icon>
          <mat-select
            [value]="selectedCityName()"
            (valueChange)="selectedCityName.set($event)"
            name="city"
            [ngModel]="selectedCityName()"
            required
            #citySelect="ngModel"
          >
            @for(city of cities(); track city.id) {
              <mat-option [value]="city.name">{{ city.name }}</mat-option>
            }
          </mat-select>
          @if (citySelect.invalid && (citySelect.touched || f.submitted)) {
            <mat-error>City required</mat-error>
          }
        </mat-form-field>

        <!-- Search Button -->
        <button 
          mat-raised-button 
          color="primary" 
          type="submit" 
          class="search-btn"
          [disabled]="!canSearch()"
        >
          <mat-icon>search</mat-icon>
          Search
        </button>
      </div>
    </form>
  }
</div>
